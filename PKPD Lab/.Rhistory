x = "Time (hr)",
y = "Concentration (pg/ml)") +
theme_minimal()
# Define parameters
params <- c(Ka = 1.8306904,
k12 = 5.7796488,
k21 = 0.2351098,
Ke = 5.0540725,
V1 = 97.3262063,
Emax = 200,
IC50 = 150)
Dose = 1
# Define initial conditions
inits <- c(a_depot = Dose,
C1 = 0,
C2 = 0,
Wrkin1 = 3.2)
# Time sequence
time <- seq(0, 24, by = 0.1)  # Simulate for 24 hours
# Simulate the model
sim_result <- ode(y = inits, times = time, func = model, parms = params)
sim_df <- as.data.frame(sim_result)
# Plot the simulation result along with the observed data
ggplot() +
geom_point(data = mad, aes(x = time_hr, y = wrkin1_pg_ml), color = 'blue') +
geom_line(data = sim_df, aes(x = time, y = Wrkin1), color = 'red') +
labs(title = "Simulated vs Observed Wrkin1 Concentration",
x = "Time (hr)",
y = "Concentration (pg/ml)") +
theme_minimal()
# Define parameters
params <- c(Ka = 1.8306904,
k12 = 5.7796488,
k21 = 0.2351098,
Ke = 5.0540725,
V1 = 97.3262063,
Emax = 500,
IC50 = 150)
Dose = 1
# Define initial conditions
inits <- c(a_depot = Dose,
C1 = 0,
C2 = 0,
Wrkin1 = 3.2)
# Time sequence
time <- seq(0, 24, by = 0.1)  # Simulate for 24 hours
# Simulate the model
sim_result <- ode(y = inits, times = time, func = model, parms = params)
sim_df <- as.data.frame(sim_result)
# Plot the simulation result along with the observed data
ggplot() +
geom_point(data = mad, aes(x = time_hr, y = wrkin1_pg_ml), color = 'blue') +
geom_line(data = sim_df, aes(x = time, y = Wrkin1), color = 'red') +
labs(title = "Simulated vs Observed Wrkin1 Concentration",
x = "Time (hr)",
y = "Concentration (pg/ml)") +
theme_minimal()
# Define parameters
params <- c(Ka = 1.8306904,
k12 = 5.7796488,
k21 = 0.2351098,
Ke = 5.0540725,
V1 = 97.3262063,
Emax = 1000,
IC50 = 150)
Dose = 1
# Define initial conditions
inits <- c(a_depot = Dose,
C1 = 0,
C2 = 0,
Wrkin1 = 3.2)
# Time sequence
time <- seq(0, 24, by = 0.1)  # Simulate for 24 hours
# Simulate the model
sim_result <- ode(y = inits, times = time, func = model, parms = params)
sim_df <- as.data.frame(sim_result)
# Plot the simulation result along with the observed data
ggplot() +
geom_point(data = mad, aes(x = time_hr, y = wrkin1_pg_ml), color = 'blue') +
geom_line(data = sim_df, aes(x = time, y = Wrkin1), color = 'red') +
labs(title = "Simulated vs Observed Wrkin1 Concentration",
x = "Time (hr)",
y = "Concentration (pg/ml)") +
theme_minimal()
# Define parameters
params <- c(Ka = 1.8306904,
k12 = 5.7796488,
k21 = 0.2351098,
Ke = 5.0540725,
V1 = 97.3262063,
Emax = 1500,
IC50 = 150)
Dose = 1
# Define initial conditions
inits <- c(a_depot = Dose,
C1 = 0,
C2 = 0,
Wrkin1 = 3.2)
# Time sequence
time <- seq(0, 24, by = 0.1)  # Simulate for 24 hours
# Simulate the model
sim_result <- ode(y = inits, times = time, func = model, parms = params)
sim_df <- as.data.frame(sim_result)
# Plot the simulation result along with the observed data
ggplot() +
geom_point(data = mad, aes(x = time_hr, y = wrkin1_pg_ml), color = 'blue') +
geom_line(data = sim_df, aes(x = time, y = Wrkin1), color = 'red') +
labs(title = "Simulated vs Observed Wrkin1 Concentration",
x = "Time (hr)",
y = "Concentration (pg/ml)") +
theme_minimal()
# Define parameters
params <- c(Ka = 1.8306904,
k12 = 5.7796488,
k21 = 0.2351098,
Ke = 5.0540725,
V1 = 97.3262063,
Emax = 1500,
IC50 = 600)
Dose = 1
# Define initial conditions
inits <- c(a_depot = Dose,
C1 = 0,
C2 = 0,
Wrkin1 = 3.2)
# Time sequence
time <- seq(0, 24, by = 0.1)  # Simulate for 24 hours
# Simulate the model
sim_result <- ode(y = inits, times = time, func = model, parms = params)
sim_df <- as.data.frame(sim_result)
# Plot the simulation result along with the observed data
ggplot() +
geom_point(data = mad, aes(x = time_hr, y = wrkin1_pg_ml), color = 'blue') +
geom_line(data = sim_df, aes(x = time, y = Wrkin1), color = 'red') +
labs(title = "Simulated vs Observed Wrkin1 Concentration",
x = "Time (hr)",
y = "Concentration (pg/ml)") +
theme_minimal()
# Define parameters
params <- c(Ka = 1.8306904,
k12 = 5.7796488,
k21 = 0.2351098,
Ke = 5.0540725,
V1 = 97.3262063,
Emax = 1500,
IC50 = 15)
Dose = 1
# Define initial conditions
inits <- c(a_depot = Dose,
C1 = 0,
C2 = 0,
Wrkin1 = 3.2)
# Time sequence
time <- seq(0, 24, by = 0.1)  # Simulate for 24 hours
# Simulate the model
sim_result <- ode(y = inits, times = time, func = model, parms = params)
sim_df <- as.data.frame(sim_result)
# Plot the simulation result along with the observed data
ggplot() +
geom_point(data = mad, aes(x = time_hr, y = wrkin1_pg_ml), color = 'blue') +
geom_line(data = sim_df, aes(x = time, y = Wrkin1), color = 'red') +
labs(title = "Simulated vs Observed Wrkin1 Concentration",
x = "Time (hr)",
y = "Concentration (pg/ml)") +
theme_minimal()
# Define parameters
params <- c(Ka = 1.8306904,
k12 = 5.7796488,
k21 = 0.2351098,
Ke = 5.0540725,
V1 = 97.3262063,
Emax = 1500,
IC50 = 60)
Dose = 1
# Define initial conditions
inits <- c(a_depot = Dose,
C1 = 0,
C2 = 0,
Wrkin1 = 3.2)
# Time sequence
time <- seq(0, 24, by = 0.1)  # Simulate for 24 hours
# Simulate the model
sim_result <- ode(y = inits, times = time, func = model, parms = params)
sim_df <- as.data.frame(sim_result)
# Plot the simulation result along with the observed data
ggplot() +
geom_point(data = mad, aes(x = time_hr, y = wrkin1_pg_ml), color = 'blue') +
geom_line(data = sim_df, aes(x = time, y = Wrkin1), color = 'red') +
labs(title = "Simulated vs Observed Wrkin1 Concentration",
x = "Time (hr)",
y = "Concentration (pg/ml)") +
theme_minimal()
# Define parameters
params <- c(Ka = 1.8306904,
k12 = 5.7796488,
k21 = 0.2351098,
Ke = 5.0540725,
V1 = 97.3262063,
Emax = 100,
IC50 = 0.6)
Dose = 1
# Define initial conditions
inits <- c(a_depot = Dose,
C1 = 0,
C2 = 0,
Wrkin1 = 3.2)
# Time sequence
time <- seq(0, 24, by = 0.1)  # Simulate for 24 hours
# Simulate the model
sim_result <- ode(y = inits, times = time, func = model, parms = params)
sim_df <- as.data.frame(sim_result)
# Plot the simulation result along with the observed data
ggplot() +
geom_point(data = mad, aes(x = time_hr, y = wrkin1_pg_ml), color = 'blue') +
geom_line(data = sim_df, aes(x = time, y = Wrkin1), color = 'red') +
labs(title = "Simulated vs Observed Wrkin1 Concentration",
x = "Time (hr)",
y = "Concentration (pg/ml)") +
theme_minimal()
# Define parameters
params <- c(Ka = 1.8306904,
k12 = 5.7796488,
k21 = 0.2351098,
Ke = 5.0540725,
V1 = 97.3262063,
Emax = 100,
IC50 = 1)
Dose = 1
# Define initial conditions
inits <- c(a_depot = Dose,
C1 = 0,
C2 = 0,
Wrkin1 = 3.2)
# Time sequence
time <- seq(0, 24, by = 0.1)  # Simulate for 24 hours
# Simulate the model
sim_result <- ode(y = inits, times = time, func = model, parms = params)
sim_df <- as.data.frame(sim_result)
# Plot the simulation result along with the observed data
ggplot() +
geom_point(data = mad, aes(x = time_hr, y = wrkin1_pg_ml), color = 'blue') +
geom_line(data = sim_df, aes(x = time, y = Wrkin1), color = 'red') +
labs(title = "Simulated vs Observed Wrkin1 Concentration",
x = "Time (hr)",
y = "Concentration (pg/ml)") +
theme_minimal()
# Define parameters
params <- c(Ka = 1.8306904,
k12 = 5.7796488,
k21 = 0.2351098,
Ke = 5.0540725,
V1 = 97.3262063,
Emax = 100,
IC50 = 10)
Dose = 1
# Define initial conditions
inits <- c(a_depot = Dose,
C1 = 0,
C2 = 0,
Wrkin1 = 3.2)
# Time sequence
time <- seq(0, 24, by = 0.1)  # Simulate for 24 hours
# Simulate the model
sim_result <- ode(y = inits, times = time, func = model, parms = params)
sim_df <- as.data.frame(sim_result)
# Plot the simulation result along with the observed data
ggplot() +
geom_point(data = mad, aes(x = time_hr, y = wrkin1_pg_ml), color = 'blue') +
geom_line(data = sim_df, aes(x = time, y = Wrkin1), color = 'red') +
labs(title = "Simulated vs Observed Wrkin1 Concentration",
x = "Time (hr)",
y = "Concentration (pg/ml)") +
theme_minimal()
# Define parameters
params <- c(Ka = 1.8306904,
k12 = 5.7796488,
k21 = 0.2351098,
Ke = 5.0540725,
V1 = 97.3262063,
Emax = 80,
IC50 = 10)
Dose = 1
# Define initial conditions
inits <- c(a_depot = Dose,
C1 = 0,
C2 = 0,
Wrkin1 = 3.2)
# Time sequence
time <- seq(0, 24, by = 0.1)  # Simulate for 24 hours
# Simulate the model
sim_result <- ode(y = inits, times = time, func = model, parms = params)
sim_df <- as.data.frame(sim_result)
# Plot the simulation result along with the observed data
ggplot() +
geom_point(data = mad, aes(x = time_hr, y = wrkin1_pg_ml), color = 'blue') +
geom_line(data = sim_df, aes(x = time, y = Wrkin1), color = 'red') +
labs(title = "Simulated vs Observed Wrkin1 Concentration",
x = "Time (hr)",
y = "Concentration (pg/ml)") +
theme_minimal()
# Define parameters
params <- c(Ka = 1.8306904,
k12 = 5.7796488,
k21 = 0.2351098,
Ke = 5.0540725,
V1 = 97.3262063,
Emax = 160,
IC50 = 10)
Dose = 1
# Define initial conditions
inits <- c(a_depot = Dose,
C1 = 0,
C2 = 0,
Wrkin1 = 3.2)
# Time sequence
time <- seq(0, 24, by = 0.1)  # Simulate for 24 hours
# Simulate the model
sim_result <- ode(y = inits, times = time, func = model, parms = params)
sim_df <- as.data.frame(sim_result)
# Plot the simulation result along with the observed data
ggplot() +
geom_point(data = mad, aes(x = time_hr, y = wrkin1_pg_ml), color = 'blue') +
geom_line(data = sim_df, aes(x = time, y = Wrkin1), color = 'red') +
labs(title = "Simulated vs Observed Wrkin1 Concentration",
x = "Time (hr)",
y = "Concentration (pg/ml)") +
theme_minimal()
source("~/BIOE8510/RSudio/In Class/Pharmacokdynamics/class.R", echo=TRUE)
source("~/BIOE8510/RSudio/PKPD Lab/Lab_pt2.R", echo=TRUE)
source("~/BIOE8510/RSudio/PKPD Lab/Lab_pt2.R", echo=TRUE)
source("~/BIOE8510/RSudio/PKPD Lab/Lab_pt2.R", echo=TRUE)
source("~/BIOE8510/RSudio/PKPD Lab/Lab_pt2.R", echo=TRUE)
# Clear the environment
rm(list = ls())
# Load required packages
library(ggplot2)
library(deSolve)
library(tidyverse)  # Load the tidyverse which includes ggplot2 and tidyr
# Set working directory (modify as needed)
setwd("C:/Users/Ethan/Documents/BIOE8510/RSudio/PKPD Lab")
# Load the data
mad <- read.csv("cureaprobex_MAD_PD.csv")
mad <- subset(mad, ID == 1 & dose == 1)
# Plotting the wrkin1 values
ggplot(mad, aes(x = time_hr, y = wrkin1_pg_ml)) +
geom_point() +
geom_line() +
labs(title = "Concentration of wrkin1 over Time",
x = "Time (hr)",
y = "Concentration (pg/ml)") +
theme_minimal()
# Define the model function
model <- function(time, inits, theta) {
with(as.list(c(inits, theta)), {
# Pharmacokinetics
dA_depot_dt <- -Ka * a_depot
dC1_dt <- (Ka * a_depot - k12 * C1 + k21 * C2 - Ke * C1) / V1
dC2_dt <- k12 * C1 - k21 * C2
# Pharmacodynamics
Effect <- 1 + (Emax * C1) / (IC50 + C1)  # Adjusted to use IC50
# Return list of derivatives
list(c(dA_depot_dt, dC1_dt, dC2_dt, Effect))
})
}
# Define parameters
params <- c(Ka = 1.8306904,
k12 = 5.7796488,
k21 = 0.2351098,
Ke = 5.0540725,
V1 = 97.3262063,
Emax = 160,
IC50 = 10)
# Define dose
Dose = 1
# Define initial conditions
inits <- c(a_depot = Dose,
C1 = 0,
C2 = 0)
# Time sequence for simulation (e.g., 0 to 24 hours)
time <- seq(0, 24, by = 0.1)
# Simulate the model
sim_result <- ode(y = inits, times = time, func = model, parms = params)
source("~/BIOE8510/RSudio/PKPD Lab/Lab_pt2.R", echo=TRUE)
source("~/BIOE8510/RSudio/PKPD Lab/Lab_pt2.R", echo=TRUE)
mad
# Smooth the wrkin1 data
mad$smoothed_wrkin1 <- predict(loess(wrkin1_pg_ml ~ time_hr, data = mad))
# Plot the original and smoothed data
ggplot(mad, aes(x = time_hr)) +
geom_point(aes(y = wrkin1_pg_ml), color = 'black') +
geom_line(aes(y = smoothed_wrkin1), color = 'blue') +
labs(title = "Observed Concentration of wrkin1 Over Time (Smoothed)",
x = "Time (hr)",
y = "Concentration (pg/ml)") +
theme_minimal()
library(nlme)
# Fit a nonlinear mixed effects model
model <- nlme(wrkin1_pg_ml ~ SSlogis(time_hr, Asym, xmid, scal),
data = mad,
fixed = Asym + xmid + scal ~ 1,
random = Asym ~ 1 | ID)
install nlme
ggplot() +
geom_line(data = sim_df_long[sim_df_long$Compartment == "C1", ], aes(x = time, y = Concentration), color = 'red') +
geom_line(data = sim_df_long[sim_df_long$Compartment == "Effect", ], aes(x = time, y = Concentration), color = 'blue') +
geom_point(data = pd_data, aes(x = time_hr, y = wrkin1_pg_ml), color = 'green') +
labs(title = "Simulated Drug Concentration and Effect vs Observed Wrkin1",
x = "Time (hr)",
y = "Concentration / Effect") +
scale_y_continuous(sec.axis = sec_axis(~., name = "Effect")) +
theme_minimal() +
theme(legend.position = "bottom")
source("~/BIOE8510/RSudio/PKPD Lab/Lab_pt2.R", echo=TRUE)
mad
head(mad)
source("~/BIOE8510/RSudio/PKPD Lab/Lab_pt2.R", echo=TRUE)
# Clear the environment
rm(list = ls())
# Load required packages
library(ggplot2)
library(deSolve)
library(tidyverse)  # Load the tidyverse which includes ggplot2 and tidyr
# Set working directory (modify as needed)
setwd("C:/Users/Ethan/Documents/BIOE8510/RSudio/PKPD Lab")
# Load the data
pd_data <- read.csv("cureaprobex_MAD_PD.csv")
# Plot the data
ggplot(pd_data, aes(x = Time, y = Wrkin1)) +
geom_line() +
labs(title = "Wrkin1 Response Over Time", x = "Time (hours)", y = "Wrkin1 Concentration") +
theme_minimal()
# Clear the environment
rm(list = ls())
# Load required packages
library(ggplot2)
library(deSolve)
library(tidyverse)  # Load the tidyverse which includes ggplot2 and tidyr
# Set working directory (modify as needed)
setwd("C:/Users/Ethan/Documents/BIOE8510/RSudio/PKPD Lab")
# Load the data
pd_data <- read.csv("cureaprobex_MAD_PD.csv")
# Plot the data
ggplot(pd_data, aes(x = Time, y = Wrkin1)) +
geom_line() +
labs(title = "Wrkin1 Response Over Time", x = "Time (hours)", y = "Wrkin1 Concentration") +
theme_minimal()
head(pd_data
)
# Clear the environment
rm(list = ls())
# Load required packages
library(ggplot2)
library(deSolve)
library(tidyverse)  # Load the tidyverse which includes ggplot2 and tidyr
# Set working directory (modify as needed)
setwd("C:/Users/Ethan/Documents/BIOE8510/RSudio/PKPD Lab")
# Load the data
pd_data <- read.csv("cureaprobex_MAD_PD.csv")
# Plot the data
ggplot(pd_data, aes(x = Time, y = wrkin1_pg_ml )) +
geom_line() +
labs(title = "Wrkin1 Response Over Time", x = "Time (hours)", y = "Wrkin1 Concentration") +
theme_minimal()
# Clear the environment
rm(list = ls())
# Load required packages
library(ggplot2)
library(deSolve)
library(tidyverse)  # Load the tidyverse which includes ggplot2 and tidyr
# Set working directory (modify as needed)
setwd("C:/Users/Ethan/Documents/BIOE8510/RSudio/PKPD Lab")
# Load the data
pd_data <- read.csv("cureaprobex_MAD_PD.csv")
# Plot the data
ggplot(pd_data, aes(x = Time, y = wrkin1_pg_ml )) +
geom_line() +
labs(title = "Wrkin1 Response Over Time", x = "Time (hours)", y = "Wrkin1 Concentration") +
theme_minimal()
# Clear the environment
rm(list = ls())
# Load required packages
library(ggplot2)
library(deSolve)
library(tidyverse)  # Load tidyverse which includes ggplot2 and other useful functions
# Set working directory (modify as needed)
setwd("C:/Users/Ethan/Documents/BIOE8510/RSudio/PKPD Lab")
# Load the data
pd_data <- read.csv("cureaprobex_MAD_PD.csv")
# Inspect the data (optional, but recommended)
str(pd_data)
head(pd_data)
# Plot the data
ggplot(pd_data, aes(x = Time, y = wrkin1_pg_ml)) +
geom_line() +
labs(title = "Wrkin1 Response Over Time", x = "Time (hours)", y = "Wrkin1 Concentration (pg/mL)") +
theme_minimal()
source("~/BIOE8510/RSudio/PKPD Lab/Lab_pt2.R", echo=TRUE)
source("~/BIOE8510/RSudio/PKPD Lab/Lab_pt2.R", echo=TRUE)
source("~/BIOE8510/RSudio/PKPD Lab/Lab_pt2.R", echo=TRUE)
source("~/BIOE8510/RSudio/PKPD Lab/Lab_pt2.R", echo=TRUE)
source("~/BIOE8510/RSudio/PKPD Lab/Lab_pt2.R", echo=TRUE)
source("~/BIOE8510/RSudio/PKPD Lab/Lab_pt2.R", echo=TRUE)
source("~/BIOE8510/RSudio/PKPD Lab/Lab_pt2.R", echo=TRUE)
source("~/BIOE8510/RSudio/PKPD Lab/Lab_pt2.R", echo=TRUE)
X
out
out
source("~/BIOE8510/RSudio/PKPD Lab/Lab_pt2.R", echo=TRUE)
out_7hr
output_df_7hr
out_7hr
source("~/BIOE8510/RSudio/PKPD Lab/Lab.R", echo=TRUE)
